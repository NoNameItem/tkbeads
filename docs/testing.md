# Тестирование tkbeads

## Приоритеты

1. Уверенность в корректности логики
2. Предотвращение регрессий
3. Документация поведения через тесты

## Уровни тестирования

| Уровень | Что проверяем | Инструменты |
|---------|---------------|-------------|
| **Unit** | Data-слой (парсинг JSONL, модели), Store-слой (распределение по колонкам, blocked/ready) | pytest, фабрики |
| **Integration** | Сценарии пользователя: навигация, смена статуса, поиск | Textual pilot, временные файлы |
| **Snapshot** | Визуальное отображение: доска, модалки, состояния | pytest-textual-snapshot (SVG) |

## Тестовые данные

- **Фабрики** — для unit-тестов, создание Task с нужными параметрами
- **Файлы-фикстуры** — для integration/snapshot, готовые .jsonl сценарии

## Структура

```
tests/
├── conftest.py          # фабрики и общие фикстуры
├── fixtures/            # .jsonl для integration/snapshot
├── unit/
├── integration/
└── snapshots/
```

## Команды

```bash
pytest                    # все тесты
pytest tests/unit         # только unit
pytest --snapshot-update  # обновить снимки
```

## CI

- Запуск: ruff check → ty check → pytest
- Расхождение snapshot — сигнал проверить визуальные изменения
